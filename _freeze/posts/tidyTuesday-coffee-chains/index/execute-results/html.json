{
  "hash": "c2be8479ce368d7485b4315f09fe5d69",
  "result": {
    "markdown": "---\ntitle: 'tidyTuesday: coffee chains'\nauthor: 'Robert W. Walker'\ndate: '2018-05-09'\ncategories:\n  - R\n  - tidyverse\n  - Maps\ntags:\n  - R\n  - tidyTuesday\n  - tidyverse\nbibliography: \"bibliography.bib\"\nnocite: |\n     @*\nformat: \n   html:\n     code-fold: true\n     code-copy: hover\n     code-block-border-left: true\n     df-print: paged\n     fig-format: retina\n     footnotes-hover: true\n     html-math-method: katex\n     toc: true\n     toc-title: Navigation\n---\n\n\n\n\n\n# The tidyTuesday for this week is coffee chain locations\n\nFor this week:\n1. The basic link to the [`#tidyTuesday`](https://github.com/rfordatascience/tidytuesday) shows [an original article](http://flowingdata.com/2014/03/18/coffee-place-geography/) for Week 6.\n\nThe page notes that Starbucks, Tim Horton, and Dunkin Donuts have raw data available.\n\n\n::: {.cell hash='index_cache/html/LoadData_15b4cec782aa0378719bfefd8289a49c'}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(geofacet)\nlibrary(ggbeeswarm)\nlibrary(ggrepel)\nStarbucks <- readRDS(url(\"https://github.com/robertwwalker/academic-mymod/raw/master/data/week6SB.rds\"))\nDunkin.Donuts <- readRDS(url(\"https://github.com/robertwwalker/academic-mymod/raw/master/data/week6DD.rds\"))\nTim.Hortons <- readRDS(url(\"https://github.com/robertwwalker/academic-mymod/raw/master/data/week6TH.rds\"))\n```\n:::\n\n\nWhat do the data look like?\n\n### Starbucks Data\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-1_3acf86cab9e809623cc0741c3a41f682'}\n\n```{.r .cell-code}\nlibrary(skimr)\nskim(Starbucks)\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |          |\n|:------------------------|:---------|\n|Name                     |Starbucks |\n|Number of rows           |25600     |\n|Number of columns        |13        |\n|_______________________  |          |\n|Column type frequency:   |          |\n|character                |11        |\n|numeric                  |2         |\n|________________________ |          |\n|Group variables          |None      |\n\n\n**Variable type: character**\n\n|skim_variable  | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:--------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|Brand          |         0|          1.00|   7|  21|     0|        4|          0|\n|Store Number   |         0|          1.00|   5|  12|     0|    25599|          0|\n|Store Name     |         0|          1.00|   2|  60|     0|    25364|          0|\n|Ownership Type |         0|          1.00|   8|  13|     0|        4|          0|\n|Street Address |         2|          1.00|   1| 234|     0|    25353|          0|\n|City           |        14|          1.00|   2|  29|     0|     5470|          0|\n|State/Province |         0|          1.00|   1|   3|     0|      338|          0|\n|Country        |         0|          1.00|   2|   2|     0|       73|          0|\n|Postcode       |      1521|          0.94|   1|   9|     0|    18888|          0|\n|Phone Number   |      6861|          0.73|   1|  18|     0|    18559|          0|\n|Timezone       |         0|          1.00|  18|  30|     0|      101|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|   mean|    sd|      p0|     p25|    p50|    p75|   p100|hist  |\n|:-------------|---------:|-------------:|------:|-----:|-------:|-------:|------:|------:|------:|:-----|\n|Longitude     |         1|             1| -27.87| 96.84| -159.46| -104.66| -79.35| 100.63| 176.92|▇▇▂▂▅ |\n|Latitude      |         1|             1|  34.79| 13.34|  -46.41|   31.24|  36.75|  41.57|  64.85|▁▁▁▇▂ |\n:::\n:::\n\n\n### Dunkin Donuts Data\n\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-2_a741ff776a7d8af9ee1918198f64160d'}\n\n```{.r .cell-code}\nskim(Dunkin.Donuts)\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |              |\n|:------------------------|:-------------|\n|Name                     |Dunkin.Donuts |\n|Number of rows           |4898          |\n|Number of columns        |22            |\n|_______________________  |              |\n|Column type frequency:   |              |\n|character                |13            |\n|numeric                  |9             |\n|________________________ |              |\n|Group variables          |None          |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|biz_name      |         0|          1.00|   8|  38|     0|       33|          0|\n|e_address     |         0|          1.00|   6|  61|     0|     4864|          0|\n|e_city        |         0|          1.00|   2|  27|     0|     1770|          0|\n|e_state       |         0|          1.00|   2|   2|     0|       41|          0|\n|e_zip_full    |         0|          1.00|  10|  10|     0|      545|          0|\n|e_country     |         0|          1.00|   3|   3|     0|        1|          0|\n|loc_county    |         0|          1.00|   3|  21|     0|      395|          0|\n|loc_PMSA      |         0|          1.00|   2|   4|     0|       53|          0|\n|loc_TZ        |         0|          1.00|   3|   5|     0|        5|          0|\n|loc_DST       |         0|          1.00|   1|   1|     0|        3|          0|\n|web_url       |         0|          1.00|  20| 175|     0|       22|          0|\n|biz_info      |      4091|          0.16|  14|  18|     0|      709|          0|\n|biz_phone     |         0|          1.00|  14|  14|     0|     4562|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable     | n_missing| complete_rate|     mean|       sd|      p0|      p25|      p50|      p75|     p100|hist  |\n|:-----------------|---------:|-------------:|--------:|--------:|-------:|--------:|--------:|--------:|--------:|:-----|\n|id                |         0|             1|  2459.46|  1420.28|    1.00|  1231.25|  2458.50|  3686.75|  4920.00|▇▇▇▇▇ |\n|e_postal          |         0|             1| 21528.34| 20311.57| 1001.00|  6080.00| 13334.50| 32810.75| 98112.00|▇▃▁▁▁ |\n|loc_area_code     |         0|             1|   590.09|   229.26|  201.00|   401.00|   610.00|   781.00|   989.00|▇▅▇▇▆ |\n|loc_FIPS          |         0|             1| 27911.17| 12470.14| 1069.00| 17031.00| 26125.00| 36111.00| 55111.00|▂▅▆▇▂ |\n|loc_MSA           |         0|             1|  4284.65|  2849.57|  160.00|  1520.00|  3800.00|  6880.00|  9320.00|▇▃▂▆▅ |\n|loc_LAT_centroid  |         0|             1|    39.62|     4.33|   21.42|    39.39|    41.22|    42.11|    47.63|▁▁▁▇▂ |\n|loc_LAT_poly      |         0|             1|    39.62|     4.32|   21.39|    39.38|    41.20|    42.09|    47.64|▁▁▁▇▂ |\n|loc_LONG_centroid |         0|             1|   -77.55|     7.31| -157.93|   -81.44|   -75.08|   -72.66|   -67.23|▁▁▁▁▇ |\n|loc_LONG_poly     |         0|             1|   -77.55|     7.31| -157.96|   -81.44|   -75.08|   -72.66|   -67.28|▁▁▁▁▇ |\n:::\n:::\n\n\n### Tim Horton's Data\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-3_8348708a09d88c4a1ce3a3b9390da831'}\n\n```{.r .cell-code}\nskim(Tim.Hortons)\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |            |\n|:------------------------|:-----------|\n|Name                     |Tim.Hortons |\n|Number of rows           |4955        |\n|Number of columns        |6           |\n|_______________________  |            |\n|Column type frequency:   |            |\n|character                |6           |\n|________________________ |            |\n|Group variables          |None        |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|country       |         0|             1|   2|   2|     0|        2|          0|\n|address       |         0|             1|   6|  51|     0|     4803|          0|\n|city          |         0|             1|   3|  38|     0|     1206|          0|\n|postal_code   |         0|             1|   4|   7|     0|     4328|          0|\n|state         |         0|             1|   2|   2|     0|       27|          0|\n|store_name    |         0|             1|   2|  63|     0|     3167|          0|\n:::\n:::\n\n\n## Plot Starbucks\n\nA basic plot of the global Starbucks data.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-4_1d3a2ff929e111ef850bd04b36eb9fd1'}\n\n```{.r .cell-code}\nlibrary(ggmap)\nmapWorld <- borders(\"world\", colour=\"gray50\", fill=\"gray50\") # create a layer of borders\nmp <- ggplot() +   mapWorld\nmp <- mp + geom_point(aes(x=Starbucks$Longitude, y=Starbucks$Latitude) ,color=\"dark green\", size=0.5) + xlab(\"\") + ylab(\"\")\nmp <- mp + geom_point(aes(x=Dunkin.Donuts$loc_LONG_centroid, y=Dunkin.Donuts$loc_LAT_centroid) ,color=\"orange\", size=0.5) + xlab(\"\") + ylab(\"\") + theme_void()\nmp\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Starbucks and Dunkin\n\nGoogle Maps interface changed and I have not updated this part.  Shame.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-5_b2032997c9c695adcabc84bbf2821177'}\n\n```{.r .cell-code}\ncoffee.xl$timhorton <- coffee.xl$timhorton %>% mutate(full.address=paste(address,city,state,toupper(country),sep=\", \"))\n# Tim.H <- coffee.xl$timhorton %>% filter(country==\"us\") %>% mutate_geocode(full.address, source=\"dsk\")\nload(paste0(here(),\"/data/geocoded.RData\"))\nTHUS <- Tim.H %>% select(country,full.address,lon,lat)\nnames(THUS) <- c(\"Country\",\"Address\",\"Longitude\",\"Latitude\")\nTHUS$chain <- \"Tim Horton's\"\nDDUS <- coffee.xl$dunkin %>% select(e_country, e_address, loc_LONG_centroid,loc_LAT_centroid)\nnames(DDUS) <- c(\"Country\",\"Address\",\"Longitude\",\"Latitude\")\nDDUS$chain <- \"Dunkin\"\nSBUX <- coffee.xl$starbucks %>% filter(Country==\"us\") %>% select(Country,`Street Address`,Longitude,Latitude)\nnames(SBUX) <- c(\"Country\",\"Address\",\"Longitude\",\"Latitude\")\nUS.Map.Coffee <- bind_rows(DDUS,SBUX,THUS)\nUSmap <- get_stamenmap(us, zoom = 5)\nmp <- ggmap(USmap)\nmp <- mp + geom_point(aes(x=Starbucks$Longitude, y=Starbucks$Latitude) ,color=\"dark green\", size=0.5) + xlab(\"\") + ylab(\"\")\nmp <- mp + geom_point(aes(x=Dunkin.Donuts$loc_LONG_centroid, y=Dunkin.Donuts$loc_LAT_centroid) ,color=\"orange\", size=0.5) + xlab(\"\") + ylab(\"\")\nmp\n```\n:::\n\n\n\n# References\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-6_13888ca2563f93a3cf04adb461ebce45'}\n\n```{.r .cell-code}\nknitr::write_bib(names(sessionInfo()$otherPkgs), file=\"bibliography.bib\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}