{
  "hash": "36d934a95d915b86ba9bed225d31349c",
  "result": {
    "markdown": "---\ntitle: Visualizing Two Qualitative Variables\nauthor: Robert W. Walker\ndate: '2023-01-25'\nslug: visualize-two-qualities\ncategories:\n  - R\n  - dataviz\n  - gpplot2\ntags:\n  - plot\nsubtitle: ''\nsummary: ''\nlastmod: '2020-09-13T20:04:06-07:00'\ntoc: true\nimage: preview.png\n---\n\n\n\n\n# Bonds\n\nA dataset for illustrating the various available visualizations needs a certain degree of richness with manageable size.  The dataset on *Bonds* contains three categorical and a few quantitative indicators sufficient to show what we might wish.\n\n## Loading the Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBonds <- read.csv(url(\"https://raw.githubusercontent.com/robertwwalker/DADMStuff/master/BondFunds.csv\"))\n```\n:::\n\n\n## A Summary\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(skimr)\nBonds %>%\n    skim()\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |Piped data |\n|Number of rows           |184        |\n|Number of columns        |9          |\n|_______________________  |           |\n|Column type frequency:   |           |\n|character                |4          |\n|numeric                  |5          |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|Fund.Number   |         0|             1|   4|   6|     0|      184|          0|\n|Type          |         0|             1|  20|  23|     0|        2|          0|\n|Fees          |         0|             1|   2|   3|     0|        2|          0|\n|Risk          |         0|             1|   7|  13|     0|        3|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable  | n_missing| complete_rate|   mean|      sd|     p0|    p25|   p50|    p75|     p100|hist  |\n|:--------------|---------:|-------------:|------:|-------:|------:|------:|-----:|------:|--------:|:-----|\n|Assets         |         0|             1| 910.65| 2253.27|  12.40| 113.72| 268.4| 621.95| 18603.50|▇▁▁▁▁ |\n|Expense.Ratio  |         0|             1|   0.71|    0.26|   0.12|   0.53|   0.7|   0.90|     1.94|▂▇▅▁▁ |\n|Return.2009    |         0|             1|   7.16|    6.09|  -8.80|   3.48|   6.4|  10.72|    32.00|▁▇▅▁▁ |\n|X3.Year.Return |         0|             1|   4.66|    2.52| -13.80|   4.05|   5.1|   6.10|     9.40|▁▁▁▅▇ |\n|X5.Year.Return |         0|             1|   3.99|    1.49|  -7.30|   3.60|   4.3|   4.90|     6.80|▁▁▁▅▇ |\n:::\n:::\n\n\nMost data types are represented.  There is no time variable so dates and the visualizations that go with time series are omitted.\n\n# Data Visualization\n\nThere are three primary visualizations that we might use for a combination of two qualities.  We will have a look at `geom_tile()`, `geom_point()`, and `geom_bar(aes(fill=))` to visualize these.  We can also make use of `facet`.  Let me work with Risk and Fees.  I will first display the relevant table.\n\n## Building a Table\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBTDF <- Bonds %>%\n    group_by(Risk, Fees) %>%\n    summarise(Count = n()) %>%\n    data.frame()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'Risk'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nBTDF %>%\n    pivot_wider(names_from = Fees, values_from = Count)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 3\n  Risk             No   Yes\n  <chr>         <int> <int>\n1 Above average    37    22\n2 Average          49    20\n3 Below average    44    12\n```\n:::\n:::\n\nThe table as a data.frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBTDF\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Risk Fees Count\n1 Above average   No    37\n2 Above average  Yes    22\n3       Average   No    49\n4       Average  Yes    20\n5 Below average   No    44\n6 Below average  Yes    12\n```\n:::\n:::\n\n\n## `geom_tile`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBTDF %>%\n    ggplot(., aes(x = Risk, y = Fees, fill = Count)) + geom_tile() + scale_fill_viridis_c() +\n    theme_minimal() + labs(fill = \"Number of Funds\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## `geom_label` a visual table\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBTDF %>%\n    ggplot(., aes(x = Risk, y = Fees, label = Count)) + geom_label() + theme_minimal() +\n    labs(subtitle = \"Counts of Funds Shown\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### A Tile Table\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBTDF %>%\n    ggplot(., aes(x = Risk, y = Fees, label = Count, fill = Count)) + geom_tile(alpha = 0.2) +\n    scale_fill_viridis_c() + geom_text() + theme_minimal() + labs(subtitle = \"Counts of Funds Shown\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n# Raw Data Plots\n\n## `geom_count()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBonds %>%\n    ggplot() + aes(x = Risk, y = Fees) + geom_count() + theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n# `geom_bar(fill=)`\n\nNow let us look at the bar plot.  First, start with Risk.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBonds %>%\n    ggplot() + aes(x = Risk) + geom_bar()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nTo add Fees to the plot, we can fill the bars.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBonds %>%\n    ggplot() + aes(x = Risk, fill = Fees) + geom_bar()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n## Conditional Probability: `(position=\"fill\")`\n\nWe can also plot this normalized by the number in each category of x so that the plots represent conditional probability.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBonds %>%\n    ggplot() + aes(x = Risk, fill = Fees) + geom_bar(position = \"fill\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}